# Chapter 3: DataFrames III ‚Äì Data Extraction

In this chapter, we focus on **extracting, accessing, and modifying** data inside DataFrames.  
We will continue using **Customer.csv** and **Order.csv**.

---

## 1. The set_index and reset_index Methods

Example: Set `AccountNumber` as index.

```python
import pandas as pd

customers = pd.read_csv("Customer.csv")
customers_indexed = customers.set_index("AccountNumber")
print(customers_indexed.head())

# Reset back to default
print(customers_indexed.reset_index().head())
```

---

## 2. Retrieve Rows by Index Position with iloc Accessor

```python
print(customers.iloc[0])      # first row
print(customers.iloc[0:3])    # first three rows
```

---

## 3. Retrieve Rows by Index Label with loc Accessor

```python
print(customers.loc[0])    # row with index label 0
```

---

## 4. Second Arguments to loc and iloc

```python
print(customers.loc[0:5, ["CustomerName", "AccountBalance"]])
print(customers.iloc[0:5, 1:3])
```

---

## 5. Overwrite Value in a DataFrame

```python
customers.loc[0, "AccountBalance"] = 99999
print(customers.head())
```

---

## 6. Overwrite Multiple Values

```python
customers.loc[0:2, ["State", "AccountBalance"]] = ["NY", 50000]
print(customers.head())
```

---

## 7. Rename Index Labels or Columns

```python
customers_renamed = customers.rename(columns={"CustomerName": "Name"})
print(customers_renamed.head())
```

---

## 8. Delete Rows or Columns from a DataFrame

```python
# Delete a column
customers_dropped = customers.drop(columns=["State"])
print(customers_dropped.head())

# Delete rows
customers_row_dropped = customers.drop(index=[0,1])
print(customers_row_dropped.head())
```

---

## 9. Create Random Sample with the sample Method

```python
print(customers.sample(3))   # pick 3 random rows
```

---

## 10. The nsmallest and nlargest Methods

```python
print(customers.nlargest(5, "AccountBalance"))
print(customers.nsmallest(5, "AccountBalance"))
```

---

## 11. Filtering with the where Method

```python
rich = customers["AccountBalance"].where(customers["AccountBalance"] > 80000)
print(rich.head())
```

---

## 12. The apply Method with DataFrames

Example: Apply 2% fee deduction on AccountBalance.

```python
customers["NetBalance"] = customers["AccountBalance"].apply(lambda x: x*0.98)
print(customers.head())
```

---

# üìù Practice Exercises

1. Set `CustomerName` as index, then reset it back.  
2. Use `.iloc` to extract the first 10 rows and 2 columns.  
3. Change the state of the first 3 customers to "TX".  
4. Drop the `State` column from customers.  
5. Find top 5 customers with highest AccountBalance.  
6. Create a new column `DoubleBalance` = 2 √ó AccountBalance using `.apply`.  
