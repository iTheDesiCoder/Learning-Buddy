# Chapter 7: Merging DataFrames in Pandas

In this chapter, we will learn how to **merge and combine DataFrames** in Pandas.  
This is very common in financial datasets where customer and order data must be linked.  
We will use **Customer.csv** and **Order.csv** for practice.

---

## 1. Intro to the Merging Module

Merging combines data from multiple DataFrames based on keys (like SQL joins).

---

## 2. The pd.concat Function I

Concatenate two DataFrames vertically (stacking rows).

```python
import pandas as pd

customers = pd.read_csv("Customer.csv")
extra_customers = customers.head(3)

concat_df = pd.concat([customers, extra_customers])
print(concat_df.tail())
```

---

## 3. The pd.concat Function II

Concatenate horizontally (adding columns).

```python
part1 = customers[["AccountNumber", "CustomerName"]]
part2 = customers[["State", "AccountBalance"]]

concat_columns = pd.concat([part1, part2], axis=1)
print(concat_columns.head())
```

---

## 4. Left Joins

Join `Customer.csv` and `Order.csv` on `AccountNumber`.

```python
orders = pd.read_csv("Order.csv")
merged_left = pd.merge(customers, orders, on="AccountNumber", how="left")
print(merged_left.head())
```

---

## 5. The left_on and right_on Parameters

If the join keys have different names.

```python
# Example only (if column names differ)
merged = pd.merge(customers, orders, left_on="AccountNumber", right_on="AccountNumber", how="inner")
```

---

## 6. Inner Joins

Only include matching records.

```python
merged_inner = pd.merge(customers, orders, on="AccountNumber", how="inner")
print(merged_inner.head())
```

---

## 7. Full-Outer Joins

Include all records from both DataFrames.

```python
merged_outer = pd.merge(customers, orders, on="AccountNumber", how="outer")
print(merged_outer.head())
```

---

## 8. Merging by Indexes with left_index and right_index

```python
customers_indexed = customers.set_index("AccountNumber")
orders_indexed = orders.set_index("AccountNumber")

merged_index = pd.merge(customers_indexed, orders_indexed, left_index=True, right_index=True, how="inner")
print(merged_index.head())
```

---

## 9. The join Method

```python
joined = customers_indexed.join(orders_indexed, how="inner")
print(joined.head())
```

---

# üìù Practice Exercises

1. Concatenate first 5 customers twice vertically.  
2. Concatenate customers into two halves horizontally.  
3. Perform a left join to include all customers and their orders.  
4. Perform an inner join to only include customers who placed orders.  
5. Merge customers and orders using index-based join.  
