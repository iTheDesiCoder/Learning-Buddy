# Bonus Chapter: Data Cleaning in Practice (Using DirtyData.csv)

In this chapter, we will work with a deliberately messy dataset **DirtyData.csv**.  
It contains missing values, wrong data types, duplicates, and invalid dates.  
This will help us practice **real-world data cleaning** steps.

---

## 1. Load the Dataset

```python
import pandas as pd

dirty = pd.read_csv("DirtyData.csv")
print(dirty.head())
print(dirty.info())
```

---

## 2. Handling Missing Values (NaN)

Check missing values:

```python
print(dirty.isna().sum())
```

Drop rows with any missing values:

```python
print(dirty.dropna().head())
```

Fill missing values:

```python
dirty["AccountBalance"] = dirty["AccountBalance"].fillna(0)
dirty["Qty"] = dirty["Qty"].fillna(dirty["Qty"].mean())
```

---

## 3. Handling Wrong Data Types

Example: Convert AccountBalance to numeric (force errors to NaN).

```python
dirty["AccountBalance"] = pd.to_numeric(dirty["AccountBalance"], errors="coerce")
print(dirty["AccountBalance"].head())
```

Example: Convert OrderDate to datetime.

```python
dirty["OrderDate"] = pd.to_datetime(dirty["OrderDate"], errors="coerce")
print(dirty["OrderDate"].head())
```

---

## 4. Detecting and Removing Duplicates

```python
print(dirty.duplicated().sum())

# Drop duplicates
dirty = dirty.drop_duplicates()
```

---

## 5. Handling Invalid Values

Check invalid text like "Missing" in Price.

```python
dirty["Price"] = pd.to_numeric(dirty["Price"], errors="coerce")
print(dirty["Price"].isna().sum())
```

Replace invalid with mean or 0:

```python
dirty["Price"] = dirty["Price"].fillna(dirty["Price"].mean())
```

---

## 6. Outlier Detection

Example: Detect unusually high quantities.

```python
print(dirty["Qty"].describe())

# Filter out outliers (Qty > 1000 as unrealistic)
dirty = dirty[dirty["Qty"] <= 1000]
```

---

## 7. Cleaning Strings

Trim spaces, convert case.

```python
dirty["CustomerName"] = dirty["CustomerName"].str.strip().str.title()
print(dirty["CustomerName"].head())
```

---

## 8. Final Cleaned Dataset

```python
print(dirty.head())
print(dirty.info())
```

---

# 📝 Practice Exercises

1. Replace missing `State` with `"Unknown"`.  
2. Drop rows where `OrderNumber` is missing.  
3. Convert all invalid `AccountBalance` entries into numeric, replace NaN with median.  
4. Remove duplicate `CustomerName` entries.  
5. Find and replace invalid dates in `OrderDate` with the current date.  
